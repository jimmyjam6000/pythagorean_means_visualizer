<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pythagorean Means (Upper Semicircle, r=1)</title>
  <style>
    body{ margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; background:#fff; color:#111; }
    .wrap{ max-width:1100px; margin:0 auto; padding:16px; display:grid; grid-template-columns:1.2fr 0.8fr; gap:16px; }
    .card{ border:1px solid #e6e6e6; border-radius:14px; padding:14px; background:#fff; }
    h1{ font-size:18px; margin:0 0 8px; }
    .row{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
    label{ font-size:14px; color:#333; }
    input[type="range"]{ width:340px; }
    .mono{ font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace; }
    .kv{ display:grid; grid-template-columns:1fr auto; gap:6px 12px; margin-top:10px; }
    .kv div{ font-size:14px; }
    .eq{ white-space:pre; font-size:13px; color:#333; line-height:1.55; }
    .hint{ margin-top:10px; font-size:13px; color:#444; }
    svg{ width:100%; height:auto; display:block; }
    .badge{ font-size:12px; border:1px solid #ddd; border-radius:999px; padding:2px 8px; color:#333; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="row" style="justify-content:space-between;">
        <h1>Pythagorean Means (upper semicircle, radius = 1)</h1>
        <span class="badge mono">a + b = 2 ⇒ AM = 1</span>
      </div>

      <!-- Normal SVG coords: +y is DOWN.
           We draw the *upper* semicircle using the correct arc sweep flag. -->
      <svg viewBox="-1.25 -1.75 2.5 2.05" aria-label="Means visualization">
        <!-- faint axes -->
        <line x1="-1.2" y1="0" x2="1.2" y2="0" stroke="#eee" stroke-width="0.01"/>
        <line x1="0" y1="-1.65" x2="0" y2="0.25" stroke="#eee" stroke-width="0.01"/>

        <!-- Upper semicircle: sweep flag = 1 makes the arc go to negative y (up) here -->
        <path d="M -1 0 A 1 1 0 0 1 1 0" fill="none" stroke="#111" stroke-width="0.02"/>

        <!-- diameter -->
        <line x1="-1" y1="0" x2="1" y2="0" stroke="#111" stroke-width="0.03"/>

        <!-- dynamic -->
        <g id="dynamic"></g>

        <text x="-1.18" y="-1.55" font-size="0.09" class="mono" fill="#111">Upper semicircle (r=1)</text>
      </svg>

      <div class="row" style="margin-top:10px;">
        <label for="bRange">Move b:</label>
        <input id="bRange" type="range" min="0.05" max="1.95" step="0.001" value="1.00"/>
        <span class="mono" id="bLabel"></span>
      </div>

      <div class="hint">
        Euclidean HM construction used here: since <span class="mono">GM=h=√(ab)</span> and <span class="mono">a+b=2</span>,
        we have <span class="mono">HM=ab=h²</span>. We construct <span class="mono">h²</span> from <span class="mono">h</span> by similar triangles (a classic “multiply lengths” construction).
      </div>
    </div>

    <div class="card">
      <h1>Values & formulas</h1>
      <div class="kv mono">
        <div>a</div><div id="aVal"></div>
        <div>b</div><div id="bVal"></div>
        <div>AM</div><div id="amVal"></div>
        <div>GM</div><div id="gmVal"></div>
        <div>HM</div><div id="hmVal"></div>
        <div>QM</div><div id="qmVal"></div>
      </div>

      <hr style="border:none;border-top:1px solid #eee; margin:12px 0;" />
      <div class="eq mono" id="eqBlock"></div>
    </div>
  </div>

<script>
(() => {
  const svgNS = "http://www.w3.org/2000/svg";
  const dyn = document.getElementById("dynamic");
  const bRange = document.getElementById("bRange");

  const bLabel = document.getElementById("bLabel");
  const aVal = document.getElementById("aVal");
  const bVal = document.getElementById("bVal");
  const amVal = document.getElementById("amVal");
  const gmVal = document.getElementById("gmVal");
  const hmVal = document.getElementById("hmVal");
  const qmVal = document.getElementById("qmVal");
  const eqBlock = document.getElementById("eqBlock");

  function el(name, attrs = {}) {
    const n = document.createElementNS(svgNS, name);
    for (const [k,v] of Object.entries(attrs)) n.setAttribute(k, v);
    return n;
  }
  function clear(node){ while(node.firstChild) node.removeChild(node.firstChild); }
  function fmt(x){ return (Math.round(x*1000)/1000).toFixed(3); }

  function update(){
    const b = parseFloat(bRange.value);
    const a = 2 - b;

    const AM = (a + b)/2;              // = 1
    const GM = Math.sqrt(a*b);         // = h
    const HM = (2*a*b)/(a+b);          // = ab (since a+b=2)
    const QM = Math.sqrt((a*a + b*b)/2);

    // Split point M on diameter [-1,1]
    const xM = 1 - b;

    // Upper semicircle is y = -sqrt(1-x^2) in SVG coordinates
    const yTop = -Math.sqrt(Math.max(0, 1 - xM*xM)); // = -GM
    const h = GM;

    // Euclidean “multiply lengths” to get h^2:
    // Make Q = (1, -h). Line OQ has equation y = -h x.
    // At x = h, y = -h^2. Vertical length from axis to that point is h^2 = HM.
    const xH = h;
    const yH = -h*h; // = -HM

    // Labels
    bLabel.textContent = `b = ${fmt(b)} (a = ${fmt(a)})`;
    aVal.textContent = fmt(a);
    bVal.textContent = fmt(b);
    amVal.textContent = fmt(AM);
    gmVal.textContent = fmt(GM);
    hmVal.textContent = fmt(HM);
    qmVal.textContent = fmt(QM);

    eqBlock.textContent =
      `AM(a,b) = (a + b)/2 = 1\n` +
      `GM(a,b) = √(ab) = ${fmt(GM)}\n` +
      `HM(a,b) = 2ab/(a + b) = ab = ${fmt(HM)}\n` +
      `QM(a,b) = √((a² + b²)/2) = ${fmt(QM)}\n`;

    // redraw
    clear(dyn);

    // a segment (left) and b segment (right)
    dyn.appendChild(el("line", { x1:-1, y1:0, x2:xM, y2:0, stroke:"#7c3aed", "stroke-width":"0.05", "stroke-linecap":"round" }));
    dyn.appendChild(el("line", { x1:xM, y1:0, x2:1, y2:0, stroke:"#06b6d4", "stroke-width":"0.05", "stroke-linecap":"round" }));

    dyn.appendChild(el("text", { x:(-1+xM)/2, y:0.14, "font-size":"0.10", fill:"#7c3aed", class:"mono" })).textContent = `a=${fmt(a)}`;
    dyn.appendChild(el("text", { x:(xM+1)/2, y:0.14, "font-size":"0.10", fill:"#06b6d4", class:"mono" })).textContent = `b=${fmt(b)}`;

    // point M
    dyn.appendChild(el("circle", { cx:xM, cy:0, r:0.03, fill:"#111" }));
    dyn.appendChild(el("text", { x:xM+0.03, y:-0.08, "font-size":"0.09", fill:"#111", class:"mono" })).textContent = "M";

    // GM construction: perpendicular from M up to semicircle
    dyn.appendChild(el("line", { x1:xM, y1:0, x2:xM, y2:yTop, stroke:"#16a34a", "stroke-width":"0.04", "stroke-linecap":"round" }));
    dyn.appendChild(el("circle", { cx:xM, cy:yTop, r:0.028, fill:"#16a34a" }));
    dyn.appendChild(el("text", { x:xM+0.05, y:yTop-0.03, "font-size":"0.10", fill:"#16a34a", class:"mono" })).textContent = `GM=${fmt(GM)}`;

    // AM = 1: show radius upward
    dyn.appendChild(el("line", { x1:0, y1:0, x2:0, y2:-1, stroke:"#f59e0b", "stroke-width":"0.035", "stroke-linecap":"round" }));
    dyn.appendChild(el("text", { x:0.05, y:-1.05, "font-size":"0.10", fill:"#f59e0b", class:"mono" })).textContent = "AM=1";

    // QM: dashed (can exceed 1)
    dyn.appendChild(el("line", {
      x1:-0.15, y1:0, x2:-0.15, y2:-QM,
      stroke:"#2563eb", "stroke-width":"0.03", "stroke-linecap":"round",
      "stroke-dasharray":"0.05 0.05"
    }));
    dyn.appendChild(el("text", { x:-0.62, y:-QM-0.02, "font-size":"0.10", fill:"#2563eb", class:"mono" })).textContent = `QM=${fmt(QM)}`;

    // --- HM Euclidean construction (inside the diagram) ---
    // Step A: build Q=(1,-h)
    const Qx = 1, Qy = -h;

    // Draw vertical at x=1 of height h (from axis up to Q)
    dyn.appendChild(el("line", { x1:1, y1:0, x2:1, y2:Qy, stroke:"#dc2626", "stroke-width":"0.02" }));
    dyn.appendChild(el("circle", { cx:Qx, cy:Qy, r:0.02, fill:"#dc2626" }));
    dyn.appendChild(el("text", { x:0.93, y:Qy-0.04, "font-size":"0.085", fill:"#dc2626", class:"mono" })).textContent = "Q";

    // Step B: line OQ
    dyn.appendChild(el("line", { x1:0, y1:0, x2:Qx, y2:Qy, stroke:"#dc2626", "stroke-width":"0.02", "stroke-dasharray":"0.04 0.04" }));

    // Step C: at x=h, drop a vertical to meet line OQ; its height is h^2 = HM
    dyn.appendChild(el("line", { x1:xH, y1:0, x2:xH, y2:yH, stroke:"#dc2626", "stroke-width":"0.035", "stroke-linecap":"round" }));
    dyn.appendChild(el("circle", { cx:xH, cy:yH, r:0.022, fill:"#dc2626" }));
    dyn.appendChild(el("text", { x:Math.min(xH+0.05, 1.05), y:yH-0.03, "font-size":"0.10", fill:"#dc2626", class:"mono" }))
      .textContent = `HM=${fmt(HM)}`;

    // small note showing HM = h^2
    dyn.appendChild(el("text", { x:-1.18, y:0.22, "font-size":"0.085", fill:"#666", class:"mono" }))
      .textContent = `Here: h=GM, and HM=h² (since a+b=2)`;
  }

  bRange.addEventListener("input", update, { passive:true });
  update();
})();
</script>
</body>
</html>
