<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pythagorean Means (r=1, a+b=2)</title>
  <style>
    body{ margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif; background:#fff; color:#111; }
    .wrap{ max-width:1200px; margin:0 auto; padding:16px; display:grid; grid-template-columns:1.25fr 0.75fr; gap:16px; }
    .card{ border:1px solid #e6e6e6; border-radius:14px; padding:14px; background:#fff; }
    h1{ font-size:18px; margin:0 0 8px; }
    .row{ display:flex; align-items:center; justify-content:space-between; gap:10px; flex-wrap:wrap; }
    .mono{ font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace; }
    .badge{ font-size:12px; border:1px solid #ddd; border-radius:999px; padding:2px 8px; color:#333; }
    .controls{ margin-top:10px; display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
    input[type="range"]{ width:380px; }
    .kv{ display:grid; grid-template-columns:1fr auto; gap:6px 12px; margin-top:10px; }
    .eq{ white-space:pre-wrap; font-size:13px; color:#333; line-height:1.55; }
    .hint{ margin-top:10px; font-size:13px; color:#444; }
    svg{ width:100%; height:auto; display:block; }
  </style>
</head>

<body>
<div class="wrap">
  <!-- LEFT: diagram -->
  <div class="card">
    <div class="row">
      <h1>Pythagorean Means (radius = 1 so AM = 1)</h1>
      <span class="badge mono">a + b = 2</span>
    </div>

    <!-- Coordinates (math):
         Circle centered at O=(0,0), radius 1, upper semicircle y>=0.
         We draw in SVG with y flipped (SVG y down), so use y_svg = -y_math.
         Diameter endpoints: (-1,0) and (1,0).
         Split point: P = (x,0) where x = a-1 = 1-b.
         Top point (where AM meets arc): C = (0,1) => SVG (0,-1).
         J is top of the vertical sagitta above P: J=(x, sqrt(1-x^2)).
         Radius R is segment OJ. Drop perpendicular from P to R at F; HM is segment FJ on R.
    -->
    <svg viewBox="-1.25 -1.25 2.5 1.7" aria-label="Pythagorean means diagram">
      <!-- semicircle + diameter -->
      <path d="M -1 0 A 1 1 0 0 1 1 0" fill="none" stroke="#111" stroke-width="0.02"/>
      <line x1="-1" y1="0" x2="1" y2="0" stroke="#111" stroke-width="0.025"/>

      <!-- end ticks -->
      <line x1="-1" y1="0" x2="-1" y2="0.06" stroke="#111" stroke-width="0.02"/>
      <line x1="1" y1="0" x2="1" y2="0.06" stroke="#111" stroke-width="0.02"/>

      <g id="dyn"></g>

      <!-- a/b labels -->
      <text id="aLab" x="-0.5" y="0.16" class="mono" font-size="0.10" text-anchor="middle">a</text>
      <text id="bLab" x="0.5" y="0.16" class="mono" font-size="0.10" text-anchor="middle">b</text>
    </svg>

    <div class="controls">
      <label for="bRange">Change:</label>
      <input id="bRange" type="range" min="0.05" max="1.95" step="0.001" value="0.328" />
      <span class="mono" id="abOut"></span>
    </div>

  <!-- RIGHT: values -->
  <div class="card">
    <h1>Values & equations</h1>

    <div class="kv mono">
      <div>a</div><div id="aVal"></div>
      <div>b</div><div id="bVal"></div>
      <div>AM (A)</div><div id="amVal"></div>
      <div>GM (G)</div><div id="gmVal"></div>
      <div>HM (H)</div><div id="hmVal"></div>
      <div>QM (Q)</div><div id="qmVal"></div>
    </div>

    <hr style="border:none;border-top:1px solid #eee; margin:12px 0;" />

    <div class="eq mono" id="eqBlock"></div>
  </div>
</div>

<script>
(() => {
  const dyn = document.getElementById("dyn");
  const bRange = document.getElementById("bRange");
  const abOut = document.getElementById("abOut");

  const aLab = document.getElementById("aLab");
  const bLab = document.getElementById("bLab");

  const aVal = document.getElementById("aVal");
  const bVal = document.getElementById("bVal");
  const amVal = document.getElementById("amVal");
  const gmVal = document.getElementById("gmVal");
  const hmVal = document.getElementById("hmVal");
  const qmVal = document.getElementById("qmVal");
  const eqBlock = document.getElementById("eqBlock");

  const svgNS = "http://www.w3.org/2000/svg";
  const el = (name, attrs={}) => {
    const n = document.createElementNS(svgNS, name);
    for (const [k,v] of Object.entries(attrs)) n.setAttribute(k, v);
    return n;
  };
  const clear = (node) => { while(node.firstChild) node.removeChild(node.firstChild); };
  const fmt = (x) => (Math.round(x*1000)/1000).toFixed(3);

  // Convert math coords (x, y up) to SVG coords (x, y down)
  const toSvg = (p) => ({ x: p.x, y: -p.y });

  // Fixed points
  const O = { x: 0, y: 0 };
  const C = { x: 0, y: 1 }; // top point of semicircle (AM radius endpoint)

  function update(){
    const b = parseFloat(bRange.value);
    const a = 2 - b;

    // Split point on diameter from (-1,0) to (1,0):
    // x = -1 + a = a-1 = 1-b
    const x = a - 1;
    const P = { x, y: 0 };

    // Geometric mean sagitta (vertical to arc)
    const G = Math.sqrt(Math.max(0, 1 - x*x)); // = sqrt(ab)
    const J = { x, y: G }; // top of the vertical

    // Means
    const AM = 1;
    const GM = Math.sqrt(a*b);
    const HM = (2*a*b)/(a+b);      // = ab because a+b=2
    const QM = Math.sqrt((a*a + b*b)/2);

    // Harmonic construction:
    // Radius R is line from O to J (direction u = J, and |J|=1 so it's already unit)
    // Foot from P onto R: F = (P·u) u. Here u=J and P·J = x^2, so F = x^2 * J.
    const F = { x: x*x*x, y: x*x*G };

    // Length along radius from F to J is |FJ| = 1 - x^2 = ab = HM. (Nice consistency check.)
    // Draw everything
    clear(dyn);

    // a/b label positions (center of each segment)
    // Left endpoint is -1, right endpoint is +1, split is at x
    aLab.setAttribute("x", (-1 + x)/2);
    bLab.setAttribute("x", (x + 1)/2);

    // Plot key points in SVG coords
    const Osvg = toSvg(O);
    const Csv = toSvg(C);
    const Psv = toSvg(P);
    const Jsv = toSvg(J);
    const Fsv = toSvg(F);

    // --- downward tick at split point P ---
dyn.appendChild(el("line", {
  x1: Psv.x,
  y1: Psv.y,
  x2: Psv.x,
  y2: Psv.y + 0.06,   // downward in SVG coords
  stroke: "#111",
  "stroke-width": "0.02"
}));


    // --- A (red): radius from O to C ---
    dyn.appendChild(el("line", { x1: Osvg.x, y1: Osvg.y, x2: Csv.x, y2: Csv.y, stroke:"#e11d48", "stroke-width":"0.01" }));
    dyn.appendChild(el("text", { x: 0.04, y: -0.55, fill:"#e11d48", "font-size":"0.14", class:"mono" })).textContent = "A";

    // --- G (blue): vertical from P to J ---
    dyn.appendChild(el("line", { x1: Psv.x, y1: Psv.y, x2: Jsv.x, y2: Jsv.y, stroke:"#2563eb", "stroke-width":"0.01" }));
    dyn.appendChild(el("text", { x: Jsv.x + 0.03, y: (Psv.y + Jsv.y)/2, fill:"#2563eb", "font-size":"0.14", class:"mono" })).textContent = "G";

    // --- Q (green): segment from P to C ---
    dyn.appendChild(el("line", { x1: Psv.x, y1: Psv.y, x2: Csv.x, y2: Csv.y, stroke:"#16a34a", "stroke-width":"0.01" }));
    dyn.appendChild(el("text", {
      x: (Psv.x + Csv.x)/2 + 0.02,
      y: (Psv.y + Csv.y)/2 - 0.02,
      fill:"#16a34a", "font-size":"0.14", class:"mono"
    })).textContent = "Q";

    // --- Harmonic construction (black helpers) ---
    // Radius R = OJ
    dyn.appendChild(el("line", { x1: Osvg.x, y1: Osvg.y, x2: Jsv.x, y2: Jsv.y, stroke:"#111", "stroke-width":"0.015" }));
    // Perpendicular from P to R hits at F: draw PF
    dyn.appendChild(el("line", { x1: Psv.x, y1: Psv.y, x2: Fsv.x, y2: Fsv.y, stroke:"#111", "stroke-width":"0.015" }));

    // Right-angle marker at F between PF and FJ (i.e., PF ⟂ R)
    // Build a small square using direction along R and direction along PF
    const ux = (J.x - O.x), uy = (J.y - O.y); // along radius (math)
    const vx = (P.x - F.x), vy = (P.y - F.y); // along PF (math)
    const nu = Math.hypot(ux, uy) || 1;
    const nv = Math.hypot(vx, vy) || 1;
    const u = { x: ux/nu, y: uy/nu };
    const v = { x: vx/nv, y: vy/nv };
    const s = 0.07; // size in math units

    const r1 = { x: F.x + u.x*s, y: F.y + u.y*s };
    const r2 = { x: r1.x + v.x*s, y: r1.y + v.y*s };
    const r3 = { x: F.x + v.x*s, y: F.y + v.y*s };
    const R1 = toSvg(r1), R2 = toSvg(r2), R3 = toSvg(r3);

    dyn.appendChild(el("path", {
      d: `M ${R1.x} ${R1.y} L ${R2.x} ${R2.y} L ${R3.x} ${R3.y}`,
      fill:"none", stroke:"#111", "stroke-width":"0.01"
    }));

    // --- H (magenta): segment FJ along the radius ---
    dyn.appendChild(el("line", { x1: Fsv.x, y1: Fsv.y, x2: Jsv.x, y2: Jsv.y, stroke:"#d946ef", "stroke-width":"0.01" }));
    dyn.appendChild(el("text", {
      x: (Fsv.x + Jsv.x)/2 + 0.02,
      y: (Fsv.y + Jsv.y)/2 - 0.02,
      fill:"#d946ef", "font-size":"0.14", class:"mono"
    })).textContent = "H";

    // mark P
    dyn.appendChild(el("circle", { cx: Psv.x, cy: Psv.y, r:"0.015", fill:"#111" }));

    // --- UI values ---
    abOut.textContent = `b=${fmt(b)} (a=${fmt(a)})`;
    aVal.textContent = fmt(a);
    bVal.textContent = fmt(b);
    amVal.textContent = fmt(AM);
    gmVal.textContent = fmt(GM);
    hmVal.textContent = fmt(HM);
    qmVal.textContent = fmt(QM);

    eqBlock.textContent =
`Given a + b = 2 (diameter = 2) and radius = 1:

Arithmetic Mean = A (red) = (a + b)/2 = 1

Geometric Mean = G (green) = √(ab)
(also G = √(1 - x²) where x = a - 1)

HM = H = 2ab/(a + b)
(equal to ab in a unit circle diameter = 2)

QM = Q = √((a² + b²)/2)
(also Q = √(1 + x²) where x = a - 1)
`;
  }

  bRange.addEventListener("input", update, { passive:true });
  update();
})();
</script>
</body>
</html>
